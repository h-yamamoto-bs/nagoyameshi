<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>NAGOYAMESHI</title>
    <!-- „Éï„Ç©„É≥„ÉàÂâäÊ∏õ: „Ç∑„Çπ„ÉÜ„É†„Éï„Ç©„É≥„Éà„ÇíÂÑ™ÂÖà‰ΩøÁî® -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- =================================== -->
    <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éò„ÉÉ„ÉÄ„Éº -->
    <!-- =================================== -->
    <nav class="navbar">
        <div class="nav-container">
            <!-- =================================== -->
            <!-- „Éñ„É©„É≥„Éâ„É≠„Ç¥ÔºàÂ∑¶ÂÅ¥Ôºâ -->
            <!-- =================================== -->
            <div class="brand">
                <a href="{% url 'shops:shop_list' %}" class="brand-link">
                    <div class="logo-wrapper">
                        <div class="logo-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <span class="brand-text">NAGOYAMESHI</span>
                    </div>
                </a>
            </div>
            
            <!-- =================================== -->
            <!-- Ê§úÁ¥¢„Éê„ÉºÔºà‰∏≠Â§ÆÔºâ -->
            <!-- =================================== -->
            <div class="search-container">
                <form action="{% url 'shops:search' %}" method="GET" id="search-form" class="search-form">
                    <div class="search-input-wrapper">
                        <i data-feather="search" class="search-icon"></i>
                        <input 
                            id="search-input" 
                            type="text" 
                            name="q" 
                            placeholder="Â∫óËàóÂêç„Éª‰ΩèÊâÄ„ÉªÈõªË©±Áï™Âè∑„ÅßÊ§úÁ¥¢" 
                            value="{{ request.GET.q }}"
                            class="search-input">
                        <button type="submit" class="search-button">
                            <i data-feather="arrow-right"></i>
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- =================================== -->
            <!-- „É¶„Éº„Ç∂„Éº„É°„Éã„É•„ÉºÔºàÂè≥ÂÅ¥Ôºâ -->
            <!-- =================================== -->
            <div class="user-menu">
                {% if user.is_authenticated %}
                    <!-- „É≠„Ç∞„Ç§„É≥Ê∏à„Åø„É¶„Éº„Ç∂„Éº -->
                    <div class="user-profile">
                        <div class="user-info">
                            <div class="user-avatar">
                                <span>{{ user.email|first|upper }}</span>
                            </div>
                            <div class="user-details">
                                <span class="user-email">{{ user.email }}</span>
                                <span class="user-status">„Ç™„É≥„É©„Ç§„É≥</span>
                            </div>
                        </div>
                        
                        <div class="user-actions">
                            <!-- „Éû„Ç§„Éö„Éº„Ç∏„Éú„Çø„É≥ -->
                            <a href="{% url 'accounts:mypage' %}" class="btn btn-secondary">
                                <i data-feather="user"></i>
                                <span>„Éû„Ç§„Éö„Éº„Ç∏</span>
                            </a>
                            
                            <!-- „É≠„Ç∞„Ç¢„Ç¶„Éà„Éú„Çø„É≥ -->
                            <a href="{% url 'accounts:logout' %}" id="logout-button" class="btn btn-danger">
                                <i data-feather="log-out"></i>
                                <span>„É≠„Ç∞„Ç¢„Ç¶„Éà</span>
                            </a>
                        </div>
                    </div>
                    
                {% else %}
                    <!-- Êú™„É≠„Ç∞„Ç§„É≥„É¶„Éº„Ç∂„Éº -->
                    <div class="auth-menu">
                        <div class="auth-buttons">
                            <a href="{% url 'accounts:login' %}" class="btn btn-outline">
                                <i data-feather="log-in"></i>
                                <span>„É≠„Ç∞„Ç§„É≥</span>
                            </a>
                            <a href="{% url 'accounts:register' %}" class="btn btn-primary">
                                <i data-feather="user-plus"></i>
                                <span>Êñ∞Ë¶èÁôªÈå≤</span>
                            </a>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </nav>

    <!-- =================================== -->
    <!-- „Çµ„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
    <!-- =================================== -->
    <div class="sub-nav">
        <div class="sub-nav-container">
            <a href="{% url 'shops:shop_list' %}" class="sub-nav-item">
                <i data-feather="home"></i>
                <span>Â∫óËàó‰∏ÄË¶ß</span>
            </a>
            <a href="{% url 'shops:review_list' %}" class="sub-nav-item">
                <i data-feather="message-square"></i>
                <span>„É¨„Éì„É•„Éº‰∏ÄË¶ß</span>
            </a>
        </div>
    </div>

    <!-- =================================== -->
    <!-- „Éï„É©„ÉÉ„Ç∑„É•„É°„ÉÉ„Çª„Éº„Ç∏Ôºà‰∏äÊõ∏„ÅçÂèØËÉΩÔºâ -->
    <!-- Â≠ê„ÉÜ„É≥„Éó„É¨„Éº„Éà„Åß block flash_messages „ÇíÁ©∫„Å´„Åô„Çã„Å®ÈùûË°®Á§∫ -->
    <!-- =================================== -->
    {% block flash_messages %}
      {% if messages %}
        <div class="messages" style="max-width: 960px; margin: 16px auto;">
          {% for message in messages %}
            <div class="alert {{ message.tags }}" role="alert" style="padding:12px 16px; border-radius:8px; margin-bottom:8px; background:#f8f9fa; border:1px solid #e9ecef;">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endblock %}

    <!-- =================================== -->
    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑÊåøÂÖ•‰ΩçÁΩÆ -->
    <!-- ÂêÑ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Åå block content „ÇÇ„Åó„Åè„ÅØ block main „Çí‰Ωø„Åà„Çã„Çà„ÅÜ‰∏°ÊñπÁî®ÊÑè -->
    <!-- =================================== -->
    <main>
      {% block content %}{% endblock %}
      {% block main %}{% endblock %}
    </main>

    <!-- =================================== -->
    <!-- „Éï„ÉÉ„Çø„Éº -->
    <!-- =================================== -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-brand">
                <div class="footer-logo">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                        <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                        <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                    </svg>
                    <span>NAGOYAMESHI</span>
                </div>
                <p class="footer-description">ÂêçÂè§Â±ã„ÅÆÁæéÂë≥„Åó„ÅÑÂ∫óËàó„ÇíË¶ã„Å§„Åë„Çà„ÅÜ</p>
            </div>
            
            <div class="footer-links">
                <div class="footer-section">
                    <h4>„Çµ„Éº„Éì„Çπ</h4>
                    <ul>
                        <li><a href="#">Â∫óËàóÊ§úÁ¥¢</a></li>
                        <li><a href="#">„É¨„Éì„É•„Éº</a></li>
                        <li><a href="#">‰∫àÁ¥Ñ</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>„Çµ„Éù„Éº„Éà</h4>
                    <ul>
                        <li><a href="#">„Éò„É´„Éó</a></li>
                        <li><a href="#">„ÅäÂïè„ÅÑÂêà„Çè„Åõ</a></li>
                        <li><a href="#">Âà©Áî®Ë¶èÁ¥Ñ</a></li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 NAGOYAMESHI. All rights reserved.</p>
        </div>
    </footer>

    <!-- =================================== -->
    <!-- Ë∂Ö„Ç™„Ç∑„É£„É¨„Å™CSS -->
    <!-- =================================== -->
    <style>
    /* =================================== */
    /* Âü∫Êú¨Ë®≠ÂÆö„Å®„É™„Çª„ÉÉ„Éà */
    /* =================================== */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    :root {
        /* „Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà */
        --primary: #6366f1;
        --primary-dark: #4f46e5;
        --primary-light: #818cf8;
        --secondary: #06b6d4;
        --secondary-dark: #0891b2;
        --danger: #ef4444;
        --danger-dark: #dc2626;
        --success: #10b981;
        --warning: #f59e0b;
        
        /* „Ç∞„É¨„Éº„Çπ„Ç±„Éº„É´ */
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
        
        /* „Éï„Ç©„É≥„Éà */
        --font-family: 'Inter', 'Noto Sans JP', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        
        /* „Ç∑„É£„Éâ„Ç¶ */
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        
        /* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    body {
        font-family: var(--font-family);
        line-height: 1.6;
        color: var(--gray-700);
        background: linear-gradient(135deg, var(--gray-50) 0%, #ffffff 100%);
        min-height: 100vh;
    }

    /* =================================== */
    /* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éê„Éº */
    /* =================================== */
    .navbar {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px) saturate(180%);
        border-bottom: 1px solid var(--gray-200);
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: var(--shadow-sm);
    }

    .nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 4rem;
    }

    /* =================================== */
    /* „Éñ„É©„É≥„Éâ„É≠„Ç¥ */
    /* =================================== */
    .brand-link {
        text-decoration: none;
        transition: var(--transition);
    }

    .brand-link:hover {
        transform: translateY(-1px);
    }

    .logo-wrapper {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .logo-icon {
        width: 2.5rem;
        height: 2.5rem;
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        border-radius: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        box-shadow: var(--shadow-md);
    }

    .brand-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--gray-800);
        letter-spacing: -0.025em;
    }

    /* =================================== */
    /* Ê§úÁ¥¢„Éê„Éº */
    /* =================================== */
    .search-container {
        flex: 1;
        max-width: 28rem;
        margin: 0 2rem;
    }

    .search-form {
        position: relative;
    }

    .search-input-wrapper {
        position: relative;
        display: flex;
        align-items: center;
        background: white;
        border: 2px solid var(--gray-200);
        border-radius: 1rem;
        box-shadow: var(--shadow-sm);
        transition: var(--transition);
        overflow: hidden;
    }

    .search-input-wrapper:focus-within {
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgb(99 102 241 / 0.1), var(--shadow-md);
    }

    .search-icon {
        position: absolute;
        left: 1rem;
        color: var(--gray-400);
        width: 1.25rem;
        height: 1.25rem;
        z-index: 10;
    }

    .search-input {
        flex: 1;
        padding: 0.875rem 1rem 0.875rem 2.75rem;
        border: none;
        outline: none;
        font-size: 0.875rem;
        color: var(--gray-700);
        background: transparent;
    }

    .search-input::placeholder {
        color: var(--gray-400);
    }

    .search-button {
        padding: 0.875rem 1.25rem;
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        border: none;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .search-button:hover {
        background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        transform: translateX(-2px);
    }

    .search-button i {
        width: 1.125rem;
        height: 1.125rem;
    }

    /* =================================== */
    /* „É¶„Éº„Ç∂„Éº„É°„Éã„É•„Éº */
    /* =================================== */
    .user-menu {
        min-width: 0;
    }

    .user-profile {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .user-avatar {
        width: 2.25rem;
        height: 2.25rem;
        background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: 600;
        font-size: 0.875rem;
    }

    .user-details {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .user-email {
        font-size: 0.875rem;
        font-weight: 500;
        color: var(--gray-800);
    }

    .user-status {
        font-size: 0.75rem;
        color: var(--success);
        font-weight: 500;
    }

    .user-actions {
        display: flex;
        gap: 0.5rem;
    }

    /* =================================== */
    /* Ë™çË®º„É°„Éã„É•„Éº */
    /* =================================== */
    .auth-menu {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 0.75rem;
    }

    .welcome-text {
        font-size: 0.8rem;
        color: var(--gray-500);
        margin: 0;
    }

    .auth-buttons {
        display: flex;
        gap: 0.5rem;
    }

    /* =================================== */
    /* „Çµ„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
    /* =================================== */
    .sub-nav {
        background: var(--gray-50);
        border-bottom: 1px solid var(--gray-200);
        padding: 0.75rem 0;
    }

    .sub-nav-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        gap: 2rem;
    }

    .sub-nav-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        color: var(--gray-600);
        text-decoration: none;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .sub-nav-item:hover {
        background: white;
        color: var(--primary);
        box-shadow: var(--shadow-sm);
    }

    .sub-nav-item i {
        width: 1rem;
        height: 1rem;
    }

    /* =================================== */
    /* „Éú„Çø„É≥„Çπ„Çø„Ç§„É´ */
    /* =================================== */
    .btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        text-decoration: none;
        border: 1px solid transparent;
        cursor: pointer;
        transition: var(--transition);
        white-space: nowrap;
    }

    .btn i {
        width: 1rem;
        height: 1rem;
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary), var(--primary-dark));
        color: white;
        box-shadow: var(--shadow-sm);
    }

    .btn-primary:hover {
        background: linear-gradient(135deg, var(--primary-dark), var(--primary));
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }

    .btn-secondary {
        background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
        color: white;
        box-shadow: var(--shadow-sm);
    }

    .btn-secondary:hover {
        background: linear-gradient(135deg, var(--secondary-dark), var(--secondary));
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }

    .btn-danger {
        background: linear-gradient(135deg, var(--danger), var(--danger-dark));
        color: white;
        box-shadow: var(--shadow-sm);
    }

    .btn-danger:hover {
        background: linear-gradient(135deg, var(--danger-dark), var(--danger));
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }

    .btn-outline {
        background: white;
        color: var(--gray-700);
        border-color: var(--gray-300);
        box-shadow: var(--shadow-sm);
    }

    .btn-outline:hover {
        background: var(--gray-50);
        border-color: var(--primary);
        color: var(--primary);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }

    /* =================================== */
    /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ */
    /* =================================== */
    .main-content {
        min-height: calc(100vh - 4rem - 12rem);
        width: 100%;
        max-width: none;
    }

    /* =================================== */
    /* „Éï„ÉÉ„Çø„Éº */
    /* =================================== */
    .footer {
        background: var(--gray-900);
        color: var(--gray-300);
        margin-top: 4rem;
    }

    .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 3rem 1.5rem 2rem;
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 2rem;
    }

    .footer-brand {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .footer-logo {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: white;
        font-weight: 600;
    }

    .footer-description {
        color: var(--gray-400);
        font-size: 0.875rem;
    }

    .footer-links {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 2rem;
    }

    .footer-section h4 {
        color: white;
        font-weight: 600;
        margin-bottom: 1rem;
    }

    .footer-section ul {
        list-style: none;
    }

    .footer-section ul li {
        margin-bottom: 0.5rem;
    }

    .footer-section ul li a {
        color: var(--gray-400);
        text-decoration: none;
        font-size: 0.875rem;
        transition: var(--transition);
    }

    .footer-section ul li a:hover {
        color: var(--primary-light);
    }

    .footer-bottom {
        border-top: 1px solid var(--gray-800);
        padding: 1.5rem;
        text-align: center;
    }

    .footer-bottom p {
        color: var(--gray-500);
        font-size: 0.875rem;
    }

    /* =================================== */
    /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥ */
    /* =================================== */
    @media (max-width: 1024px) {
        .nav-container {
            padding: 0 1rem;
        }
        
        .search-container {
            margin: 0 1rem;
            max-width: 20rem;
        }
        
        .user-details {
            display: none;
        }
    }

    @media (max-width: 768px) {
        .nav-container {
            flex-direction: column;
            height: auto;
            padding: 1rem;
            gap: 1rem;
        }
        
        .search-container {
            order: 3;
            max-width: 100%;
            margin: 0;
        }
        
        .user-menu {
            order: 2;
            align-self: flex-end;
        }
        
        .brand-text {
            font-size: 1.125rem;
        }
        
        .footer-content {
            grid-template-columns: 1fr;
            gap: 2rem;
        }
        
        .footer-links {
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
    }

    @media (max-width: 480px) {
        .brand-text {
            display: none;
        }
        
        .user-actions {
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .btn {
            padding: 0.375rem 0.75rem;
            font-size: 0.8rem;
        }
        
        .search-input {
            font-size: 0.8rem;
        }
    }

    /* =================================== */
    /* „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÂØæÂøúÔºàÂ∞ÜÊù•ÁöÑ„Å™Êã°ÂºµÔºâ */
    /* =================================== */
    @media (prefers-color-scheme: dark) {
        /* „ÉÄ„Éº„ÇØ„É¢„Éº„Éâ„ÅÆË®≠ÂÆö„ÅØÂ∞ÜÊù•ËøΩÂä†ÂèØËÉΩ */
    }

    /* =================================== */
    /* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
    /* =================================== */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(1rem);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .main-content > * {
        animation: fadeInUp 0.6s ease-out;
    }
    </style>

    {% block extra_scripts %}{% endblock %}

    <script>
        // Feather Icons„ÅÆÂàùÊúüÂåñ
    </script>

    <!-- „Ç¢„Ç§„Ç≥„É≥Áî®CSSÔºàÂ§ñÈÉ®„É™„ÇØ„Ç®„Çπ„ÉàÂâäÊ∏õÔºâ -->
    <style>
        .search-icon::before { content: "üîç"; }
        .user-icon::before { content: "üë§"; }
        .logout-icon::before { content: "üö™"; }
        .login-icon::before { content: "üîë"; }
        .register-icon::before { content: "üìù"; }
        .premium-icon::before { content: "‚≠ê"; }
        .mypage-icon::before { content: "üè†"; }
        .heart-icon::before { content: "‚ù§Ô∏è"; }
        .edit-icon::before { content: "‚úèÔ∏è"; }
        .delete-icon::before { content: "üóëÔ∏è"; }
        .cancel-icon::before { content: "‚ùå"; }
        .success-icon::before { content: "‚úÖ"; }
        .info-icon::before { content: "‚ÑπÔ∏è"; }
        .warning-icon::before { content: "‚ö†Ô∏è"; }
    </style>
</body>
</html>